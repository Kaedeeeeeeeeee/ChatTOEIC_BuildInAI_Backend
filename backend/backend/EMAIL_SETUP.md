# ğŸ“§ ChatTOEIC é‚®ä»¶ç³»ç»Ÿé…ç½®æŒ‡å—

## ç¯å¢ƒå˜é‡é…ç½®

ä¸ºäº†ä½¿é‚®ä»¶ç³»ç»Ÿæ­£å¸¸å·¥ä½œï¼Œéœ€è¦åœ¨ `.env` æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```env
# Resend é‚®ä»¶æœåŠ¡é…ç½®
RESEND_API_KEY=your_resend_api_key_here

# é‚®ä»¶å‘é€é…ç½®
EMAIL_FROM=ChatTOEIC <noreply@chattoeic.com>

# å‰ç«¯URL (ç”¨äºç”ŸæˆéªŒè¯é“¾æ¥)
FRONTEND_URL=https://www.chattoeic.com
```

## Resend API Key è·å–æ­¥éª¤

1. è®¿é—® [Resend](https://resend.com) å®˜ç½‘
2. æ³¨å†Œè´¦å·å¹¶ç™»å½•
3. åˆ›å»ºæ–°çš„ API Key
4. å°† API Key å¤åˆ¶åˆ° `.env` æ–‡ä»¶ä¸­

## é‚®ä»¶ç³»ç»ŸåŠŸèƒ½

### âœ… å·²å®ç°åŠŸèƒ½

1. **æ³¨å†ŒéªŒè¯é‚®ä»¶**
   - ç”¨æˆ·æ³¨å†Œåè‡ªåŠ¨å‘é€éªŒè¯ç é‚®ä»¶
   - 10åˆ†é’Ÿæœ‰æ•ˆæœŸ
   - æœ€å¤š5æ¬¡éªŒè¯å°è¯•

2. **é‚®ä»¶éªŒè¯API**
   - `POST /api/auth/verify-email` - éªŒè¯é‚®ç®±
   - `POST /api/auth/resend-verification` - é‡å‘éªŒè¯é‚®ä»¶
   - `GET /api/auth/verification-status` - æŸ¥è¯¢éªŒè¯çŠ¶æ€

3. **å¯†ç é‡ç½®ç³»ç»Ÿ** âœ¨ æ–°å¢
   - å®‰å…¨çš„é‡ç½®ä»¤ç‰Œç”Ÿæˆå’Œç®¡ç†
   - 1å°æ—¶æœ‰æ•ˆæœŸï¼Œé˜²æš´åŠ›ç ´è§£ä¿æŠ¤
   - ä¸“ä¸šçš„é‡ç½®é‚®ä»¶å’ŒæˆåŠŸç¡®è®¤é‚®ä»¶

4. **å¯†ç é‡ç½®API**
   - `POST /api/auth/request-password-reset` - ç”³è¯·å¯†ç é‡ç½®
   - `POST /api/auth/verify-reset-token` - éªŒè¯é‡ç½®ä»¤ç‰Œ
   - `POST /api/auth/reset-password` - é‡ç½®å¯†ç 
   - `GET /api/auth/password-reset-status` - æŸ¥è¯¢é‡ç½®çŠ¶æ€

5. **é‚®ä»¶æ¨¡æ¿ç»„ä»¶**
   - React Email ç»„ä»¶åŒ–æ¨¡æ¿
   - Tailwind CSS æ ·å¼
   - å“åº”å¼è®¾è®¡

### ğŸ”„ å¼€å‘ä¸­åŠŸèƒ½

- é‚®ç®±å˜æ›´ç¡®è®¤é‚®ä»¶
- ç³»ç»Ÿé€šçŸ¥é‚®ä»¶
- åŠŸèƒ½æ¨é€é‚®ä»¶

## æ•°æ®åº“æ‰©å±•

æ–°å¢äº†ä»¥ä¸‹æ•°æ®è¡¨ï¼š

- `EmailLog` - é‚®ä»¶å‘é€è®°å½•
- `EmailTemplate` - é‚®ä»¶æ¨¡æ¿ç®¡ç†
- `UserEmailPreference` - ç”¨æˆ·é‚®ä»¶åå¥½
- `EmailStats` - é‚®ä»¶ç»Ÿè®¡

## API ç«¯ç‚¹

### è®¤è¯ç›¸å…³é‚®ä»¶

```typescript
// æ³¨å†Œæ—¶è‡ªåŠ¨å‘é€éªŒè¯é‚®ä»¶
POST /api/auth/register
{
  "email": "user@example.com",
  "password": "password123",
  "name": "ç”¨æˆ·å"
}

// éªŒè¯é‚®ç®±
POST /api/auth/verify-email
{
  "email": "user@example.com",
  "code": "123456"
}

// é‡å‘éªŒè¯é‚®ä»¶
POST /api/auth/resend-verification
{
  "email": "user@example.com"
}

// æŸ¥è¯¢éªŒè¯çŠ¶æ€
GET /api/auth/verification-status?email=user@example.com
```

### å¯†ç é‡ç½®ç›¸å…³ âœ¨ æ–°å¢

```typescript
// ç”³è¯·å¯†ç é‡ç½®
POST /api/auth/request-password-reset
{
  "email": "user@example.com"
}

// éªŒè¯é‡ç½®ä»¤ç‰Œ
POST /api/auth/verify-reset-token
{
  "token": "64ä½hexå­—ç¬¦ä¸²"
}

// é‡ç½®å¯†ç 
POST /api/auth/reset-password
{
  "token": "64ä½hexå­—ç¬¦ä¸²",
  "newPassword": "newPassword123"
}

// æŸ¥è¯¢é‡ç½®çŠ¶æ€
GET /api/auth/password-reset-status?email=user@example.com
```

## é‚®ä»¶æ¨¡æ¿

### æ³¨å†ŒéªŒè¯é‚®ä»¶

- **æ¨¡æ¿ä½ç½®**: `src/emails/templates/auth/VerificationEmail.tsx`
- **åŒ…å«å†…å®¹**: 
  - ä¸ªæ€§åŒ–é—®å€™è¯­
  - 6ä½éªŒè¯ç 
  - ä¸€é”®éªŒè¯æŒ‰é’®
  - åŠŸèƒ½ä»‹ç»
  - å®‰å…¨æç¤º

### å¯†ç é‡ç½®é‚®ä»¶ âœ¨ æ–°å¢

- **æ¨¡æ¿ä½ç½®**: `src/emails/templates/auth/PasswordResetEmail.tsx`
- **åŒ…å«å†…å®¹**:
  - ä¸ªæ€§åŒ–é—®å€™è¯­
  - å®‰å…¨çš„é‡ç½®é“¾æ¥
  - 1å°æ—¶æœ‰æ•ˆæœŸæç¤º
  - å®‰å…¨è­¦å‘Šå’Œå»ºè®®
  - å¯†ç å®‰å…¨æœ€ä½³å®è·µ

### å¯†ç é‡ç½®æˆåŠŸé‚®ä»¶ âœ¨ æ–°å¢

- **æ¨¡æ¿ä½ç½®**: `src/emails/templates/auth/PasswordResetSuccessEmail.tsx`
- **åŒ…å«å†…å®¹**:
  - é‡ç½®ç¡®è®¤ä¿¡æ¯
  - æ“ä½œæ—¶é—´å’Œè®¾å¤‡ä¿¡æ¯
  - å®‰å…¨æé†’
  - å¿«é€Ÿç™»å½•é“¾æ¥
  - å¯ç–‘æ´»åŠ¨æŠ¥å‘ŠæŒ‡å¼•

### åŸºç¡€ç»„ä»¶

- `Layout` - é€šç”¨é‚®ä»¶å¸ƒå±€
- `Header` - ChatTOEIC å“ç‰Œå¤´éƒ¨
- `Footer` - ç»Ÿä¸€é¡µè„šå’Œé€€è®¢é“¾æ¥
- `Button` - CTA æŒ‰é’®ç»„ä»¶
- `VerificationCode` - éªŒè¯ç å±•ç¤ºç»„ä»¶

## é”™è¯¯å¤„ç†

é‚®ä»¶ç³»ç»ŸåŒ…å«å®Œå–„çš„é”™è¯¯å¤„ç†ï¼š

- éªŒè¯ç è¿‡æœŸè‡ªåŠ¨æ¸…ç†
- å‘é€å¤±è´¥é‡è¯•æœºåˆ¶
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æ¶ˆæ¯

## ç›‘æ§ä¸ç»Ÿè®¡

- é‚®ä»¶å‘é€æˆåŠŸ/å¤±è´¥ç»Ÿè®¡
- ç”¨æˆ·é‚®ä»¶åå¥½ç®¡ç†
- å‘é€è®°å½•æŒä¹…åŒ–å­˜å‚¨
- æ€§èƒ½ç›‘æ§æŒ‡æ ‡

## ä¸‹ä¸€æ­¥å¼€å‘

1. åˆ›å»ºå¯†ç é‡ç½®é‚®ä»¶æ¨¡æ¿
2. å®ç°é‚®ç®±å˜æ›´ç¡®è®¤æµç¨‹
3. æ·»åŠ ç³»ç»Ÿé€šçŸ¥é‚®ä»¶
4. å¼€å‘åŠŸèƒ½æ¨é€é‚®ä»¶ç³»ç»Ÿ
5. å®ç°é‚®ä»¶ç»Ÿè®¡åˆ†æé¢æ¿